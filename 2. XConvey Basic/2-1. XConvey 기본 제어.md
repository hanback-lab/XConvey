# XConvey 제어 프로그래밍 
XConvey는 스마트 팩토리를 소형화 하여 실습해볼 수 있는 장비입니다. 파이썬을 기반으로 HMI 및 Auto 제어기를 제어하여 다양한 실습을 진행해 보도록 하겠습니다. 

## pop-xconvey 
pop-xconvey 는 XConvey 제어를 위한 파이썬 라이브러리입니다. pip 를 통해 손쉽게 설치하여 사용할 수 있습니다. 

```sh
pip install pop-xconvey 
```

pop-xconvey 에서 제공되는 각종 클래스 및 메소드의 상세 설명은 아래 링크를 확인하시기 바랍니다. 

- [Pop XConvey API Documents]()

## 연결 설정 파일 생성 
pop-xconvey 활용에 앞서 연결 설정 파일을 생성합니다. 접속할 브로커의 주소, 장비 고유번호, 등의 정보를 **"product"** 파일로 저장하고 해당 정보를 읽어 활용합니다. 아래는 작성 예시입니다.

```conf
BROKER_DOMAIN=mqtt.eclipseprojects.io
DEVICE_NAME=xconvey
DEV_NUM=01
INSITUTION_NAME=hbe
```

BROKER_DOMAIN 에는 접속할 브로커의 주소를 입력합니다. 기본은 "mqtt.eclipseprojects.io" 입니다. DEVICE_NAME 은 장비의 이름으로 XConvey 은 'xconvey' 으로 기본 설정되어 있습니다. DEV_NUM 은 장치의 고유 번호로 여러개의 장비가 존재하는 경우에는 이 번호를 중복되지 않게 설정해야 합니다. INSITUTION_NAME 은 학교 또는 기관의 명칭을 고유 키워드로 활용합니다. 

## Actuator 제어 

### 상태등 제어 
XConvey 에는 현재 동작 상태를 표기할 수 있는 상태등이 있습니다. 3가지 색상(빨강, 노랑, 초록)을 통해 현재 상태를 표현할 수 있습니다. xconvey 라이브러리의 Indicator 클래스를 통해 제어할 수 있습니다. 

```python
from xconvey import Indicator 
... 
```

on() 과 off() 메소드를 통해 상태등을 켜거나 끌 수 있습니다. on()에는 켜고자하는 색상의 문자를 전달인자로 전달해야 원하는 색상을 켤 수 있습니다. 

### 컨베이어 벨트 제어 
컨베이어 벨트는 Transfer 클래스를 활용하여 제어합니다. run() 메소드를 통해 동작을 시작하고 stop() 메소드를 통해 정지 시킬 수 있습니다. 컨베이어 벨트의 동작 속도는 총 11단계로 0 단계 에서는 정지하며, 1~10 단계 까지 미리 정의된 속도에 따라 움직입니다. run() 메소드를 호출할 때 인자로 단계를 지정하면 지정한 단계에 따라 컨베이어 벨트가 동작합니다. 

```python
from xconvey import Transfer 
...
```

### 서보 모터 제어 
XConvey 의 서보 모터는 총 3개가 장착되어 있습니다. 3개는 각각 공급, 가공, 분류에 각각 활용됩니다. 

#### 공급 서보 모터 제어 
공급 서보모터는 XConvey의 좌측에 위치하고 있으며, 물체를 컨베이어 벨트에 공급하는 역할을 담당합니다. 
```python
from xconvey import Feeding 
...
```

#### 가공 서보 모터 제어 
가공 서보 모터는 XConvey의 중앙에 위치하고 있으며, 물체에 도장을 찍는 역할로 공급된 물체를 가공하는 역할입니다. 

```python 
from xconvey import Stamp
...
```

#### 분류 서보 모터 제어 
분류 서보 모터는 가공된 물체가 카메라 또는 금속 탐지 센서를 활용해 물체 가공이 정상 수행되었는지 판단하여 분류하는 역할로 사용합니다. 

```python
from xconvey import Sort 
```

## Sensor 모니터링 

### Photo 센서 모니터링 

### 금속 감지 

